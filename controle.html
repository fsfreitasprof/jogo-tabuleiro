<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Painel de Controle</title>
<style>
body {
    font-family: Arial, sans-serif;
    background: #f1f5f9;
    margin: 0;
    padding: 20px;
}
h2 { margin-top: 40px; }
.container {
    display: flex;
    flex-direction: column;
    gap: 10px;
    max-width: 600px;
    margin: auto;
}
input[type="number"] {
    width: 60px;
}
.color-section {
    border: 1px solid #ccc;
    border-radius: 10px;
    padding: 15px;
    background: #fff;
}
button {
    background: #2563eb;
    color: white;
    border: none;
    padding: 10px 20px;
    border-radius: 8px;
    font-weight: bold;
    cursor: pointer;
    margin-top: 20px;
}
</style>
</head>
<body>
<div class="container">
    <h1>Controle de Sorteio</h1>

    <div class="color-section">
        <h2>Probabilidades</h2>
        <label>Verde: <input id="verdeProb" type="number" min="0" value="2"></label><br>
        <label>Vermelho: <input id="vermelhoProb" type="number" min="0" value="1"></label><br>
        <label>Amarelo: <input id="amareloProb" type="number" min="0" value="1"></label>
    </div>

    <div id="listas"></div>

    <button onclick="salvarConfig()">Salvar Configurações</button>
</div>

<script>
const cores = ["verde", "vermelho", "amarelo"];

async function carregarListas() {
    const listasDiv = document.getElementById("listas");
    listasDiv.innerHTML = "";

    for (const cor of cores) {
        const resp = await fetch(`eventos/${cor}/?v=${Date.now()}`);
        const html = await resp.text();

        // GitHub Pages não permite listar diretórios, então usamos nomes fixos
        const arquivos = ["padrao.txt"]; // pode adicionar manualmente novos arquivos

        const section = document.createElement("div");
        section.className = "color-section";
        section.innerHTML = `<h2>${cor.charAt(0).toUpperCase() + cor.slice(1)}</h2>`;
        arquivos.forEach(a => {
            const id = `${cor}-${a}`;
            section.innerHTML += `<label><input type="checkbox" id="${id}" checked> ${a}</label><br>`;
        });
        listasDiv.appendChild(section);
    }
}

function salvarConfig() {
    const config = {
        probabilidades: {
            verde: parseInt(document.getElementById("verdeProb").value),
            vermelho: parseInt(document.getElementById("vermelhoProb").value),
            amarelo: parseInt(document.getElementById("amareloProb").value)
        },
        listas: {}
    };

    for (const cor of cores) {
        const marcados = [];
        document.querySelectorAll(`[id^=${cor}-]`).forEach(chk => {
            if (chk.checked) marcados.push(chk.id.split("-")[1]);
        });
        config.listas[cor] = marcados;
    }

    const blob = new Blob([JSON.stringify(config, null, 2)], { type: "application/json" });
    const url = URL.createObjectURL(blob);
    const a = document.createElement("a");
    a.href = url;
    a.download = "config.json";
    a.click();
    URL.revokeObjectURL(url);
}

carregarListas();
</script>
</body>
</html>
